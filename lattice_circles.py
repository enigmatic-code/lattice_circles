#!/usr/bin/env python -t
# -*- mode: Python; py-indent-offset: 2; -*-

from __future__ import print_function

# smallest radius found so far
# n -> (radius^2, centre) (other centres may exist)
# fractions a/b are expressed as (a, b)
minimal = {

  # these are minimal found by exhaustive search up to r < 1802 (using lattice-circles8t.py)
  0: ((0, 1), ((1, 2), (1, 2))), # or any non-lattice point
  1: ((0, 1), ((0, 1), (0, 1))),
  2: ((1, 4), ((1, 2), (0, 1))),
  3: ((25, 18), ((1, 6), (1, 6))),
  4: ((1, 2), ((1, 2), (1, 2))),
  5: ((625, 18), ((1, 6), (1, 6))),
  6: ((25, 4), ((1, 2), (0, 1))),
  7: ((138125, 242), ((9, 22), (5, 22))),
  8: ((5, 2), ((1, 2), (1, 2))),
  9: ((4225, 18), ((1, 6), (1, 6))),
  10: ((625, 4), ((1, 2), (0, 1))),
  11: ((801125, 242), ((5, 22), (3, 22))),
  12: ((25, 2), ((1, 2), (1, 2))),
  13: ((1221025, 98), ((1, 14), (1, 14))),
  14: ((15625, 4), ((1, 2), (0, 1))),
  15: ((105625, 18), ((1, 6), (1, 6))),
  16: ((65, 2), ((1, 2), (1, 2))),
  17: ((185870425, 578), ((9, 34), (1,34))),
  18: ((4225, 4), ((1, 2), (0, 1))),
  19: ((185870425, 578), ((13, 34), (7,34))),
  20: ((625, 2), ((1, 2), (1, 2))),
  21: ((29641625, 242), ((5, 22), (1, 22))),
  22: ((29641625, 242), ((1, 2), (9, 22))),
  23: ((30525625, 98), ((5, 14), (5, 14))),
  24: ((325, 2), ((1, 2), (1, 2))),
  25: ((17850625, 18), ((1, 6), (1, 6))),
  26: ((35409725, 98), ((1, 2), (3, 14))),
  27: ((1221025, 18), ((1, 6), (1, 6))),
  28: ((15625, 2), ((1, 2), (1, 2))),
  30: ((105625, 4), ((1, 2), (0, 1))),
  32: ((1105, 2), ((1, 2), (1, 2))),
  36: ((4225, 2), ((1, 2), (1, 2))),
  40: ((8125, 2), ((1, 2), (1, 2))),
  42: ((2640625, 4), ((1, 2), (0, 1))),
  43: ((1215306625, 242), ((3, 22), (1, 22))),
  44: ((9765625, 2), ((1, 2), (1, 2))),
  45: ((30525625, 18), ((1, 6), (1, 6))),
  48: ((5525, 2), ((1, 2), (1, 2))),
  50: ((17850625, 4), ((1, 2), (0, 1))),
  52: ((1310159825, 98), ((3, 14), (3, 14))),
  54: ((1221025, 4), ((1, 2), (0, 1))),
  56: ((203125, 2), ((1, 2), (1, 2))),
  60: ((105625, 2), ((1, 2), (1, 2))),
  64: ((27625, 2), ((1, 2), (1, 2))),
  72: ((71825, 2), ((1, 2), (1, 2))),
  80: ((138125, 2), ((1, 2), (1, 2))),
  84: ((2640625, 2), ((1, 2), (1, 2))),
  90: ((30525625, 4), ((1, 2), (0, 1))),
  96: ((160225, 2), ((1, 2), (1, 2))),
  100: ((17850625, 2), ((1, 2), (1, 2))),
  108: ((1221025, 2), ((1, 2), (1, 2))),
  112: ((3453125, 2), ((1, 2), (1, 2))),
  120: ((1795625, 2), ((1, 2), (1, 2))),
  128: ((801125, 2), ((1, 2), (1, 2))),
  144: ((2082925, 2), ((1, 2), (1, 2))),
  160: ((4005625, 2), ((1, 2), (1, 2))),
  168: ((44890625, 2), ((1, 2), (1, 2))),
  180: ((30525625, 2), ((1, 2), (1, 2))),
  192: ((5928325, 2), ((1, 2), (1, 2))),
  200: ((303460625, 2), ((1, 2), (1, 2))),
  216: ((35409725, 2), ((1, 2), (1, 2))),
  224: ((100140625, 2), ((1, 2), (1, 2))),
  240: ((52073125, 2), ((1, 2), (1, 2))),  
  256: ((29641625, 2), ((1, 2), (1, 2))),
  288: ((77068225, 2), ((1, 2), (1, 2))),
  320: ((148208125, 2), ((1, 2), (1, 2))),
  384: ((243061325, 2), ((1, 2), (1, 2))),

}


# these are best found so far, but not necessarily minimal
maybe = {

  29: ((3159797225, 722), ((13, 38), (5, 38))), # or (15/38, 11/38)
  31: ((763140625, 98), ((3, 14), (3, 14))),
  33: ((1346691125, 162), ((7, 18), (3, 18))),
  34: ((11338095925, 578), ((1, 2), (15, 34))),
  35: ((446265625, 18), ((1, 6), (1, 6))),
  37: ((3705203125, 242), ((9, 22), (1, 22))),
  38: ((3705203125, 242), ((11, 22), (7, 22))),
  39: ((1026882025, 98), ((1, 14), (1, 14))),
  41: ((2052543025, 98), ((1, 14), (1, 14))),
  46: ((885243125, 98), ((7, 14), (1, 14))),
  53: ((6076533125, 242), ((7, 22), (1, 22))),
  63: ((763140625, 18), ((1, 6), (1, 6))),
  81: ((1026882025, 18), ((1, 6), (1, 6))),
  88: ((126953125, 2), ((1, 2), (1, 2))),

  47: ((132468422125, 484), ((2, 11), (1, 22))),
  49: ((175389495125, 722), ((11, 38), (1, 38))),
  51: ((64411251125, 722), ((5, 38), (1, 38))), # or (13/38, 3/38)
  55: ((69438470725, 256), ((3, 8), (1, 16))),
  57: ((167469252925, 722), ((15, 38), (5, 38))),
  58: ((167469252925, 722), ((7, 38), (7, 38))), # or (13/38, 9/38)
  59: ((399598746625, 722), ((17, 38), (5, 38))),
  61: ((837346264625, 484), ((3, 22), (1, 11))),
  62: ((22131078125, 98), ((7, 14), (5, 14))),
  65: ((2160388179625, 1058), ((7, 46), (3, 46))),
  66: ((25672050625, 98), ((7, 14), (1, 14))),
  67: ((51313575625, 98), ((5, 14), (5, 14))),
  68: ((51313575625, 98), ((1, 2), (1, 14))),
  69: ((25672050625, 98), ((5, 14), (5, 14))),
  70: ((446265625, 4), ((1, 2), (1, 2))),
  71: ((8102935391525, 1058), ((9, 46), (3, 46))),
  73: ((12058230426125, 1682), ((15, 58), (7, 58))),
  74: ((151913328125, 242), ((3, 22), (3, 22))),
  75: ((5158830625, 18), ((1, 6), (1, 6))),
  76: ((226017390625, 242), ((9, 22), (9, 22))),
  77: ((785817263725, 722), ((7, 38), (5, 38))), # or (15/38, 1/38)
  78: ((37994634925, 98), ((1, 2), (5, 14))),
  79: ((2280063436625, 722), ((17, 38), (9, 38))),
  82: ((59523747725, 98), ((1, 2), (3, 14))),
  83: ((4186731323125, 484), ((5, 11), (3, 22))),
  85: ((64411251125, 242), ((9, 22), (3, 22))),
  86: ((64411251125, 242), ((1, 22), (1, 22))),
  87: ((2846977299725, 722), ((11, 38), (5, 38))),
  89: ((1735961768125, 256), ((5, 16), (1, 8))),
  91: ((1735961768125, 256), ((3, 8), (5, 16))),
  92: ((32753995625, 98), ((1, 14), (1, 14))),
  93: ((641801265625, 98), ((3, 14), (3, 14))),
  94: ((1282839390625, 98), ((1, 2), (5, 14))),
  95: ((23746646828125, 256), ((5, 16), (1, 8))),
  95: ((1282839390625, 98), ((3, 14), (3, 14))),
  97: ((26356735791425, 1058), ((9, 46), (1, 46))),
  98: ((75418890625, 4), ((1, 2), (0, 1))),
  99: ((1282839390625, 64), ((1, 8), (0, 1))),
  101: ((7190969300125, 722), ((13, 38), (11, 38))),
  102: ((3929086318625, 722), ((1, 2), (3, 38))), # or (13/38, 7/38)
  103: ((3929086318625, 722), ((17, 38), (9, 38))),
  104: ((69438470725, 98), ((1, 14), (1, 14))),
  105: ((128970765625, 18), ((1, 6), (1, 6))),
  106: ((322056255625, 242), ((7, 22), (7, 22))),
  107: ((322056255625, 242), ((3, 22), (1, 22))),
  109: ((128575962633625, 1682), ((23, 58), (17, 58))),
  110: ((4235746714225, 256), ((1, 2), (7, 16))),
  111: ((6228446453125, 162), ((7, 18), (1, 18))),
  113: ((37518887457025, 722), ((11, 38), (5, 38))),
  114: ((12225255463525, 722), ((9, 38), (9, 38))),
  115: ((10215624428425, 722), ((7, 38), (1, 38))), # or (11/38, 9/38)
  116: ((10215624428425, 722), ((5, 38), (5, 38))),
  117: ((1405801492225, 98), ((5, 14), (5, 14))),
  118: ((8145666758125, 256), ((3, 8), (3, 16))),
  119: ((454719867850625, 1922), ((21, 62), (1, 62))),
  121: ((7637512596025, 98), ((5, 14), (5, 14))),
  122: ((8145666758125, 256), ((3, 16), (1, 8))),
  123: ((1726188684025, 98), ((1, 14), (1, 14))),
  124: ((818849890625, 98), ((5, 14), (5, 14))),
  125: ((1490902050625, 18), ((1, 6), (1, 6))),
  126: ((763140625, 4), ((1, 2), (0, 1))),
  127: ((43399044203125, 256), ((7, 16), (1, 8))),
  129: ((4522155951625, 242), ((7, 22), (5, 22))),
  130: ((82562341692025, 722), ((1, 2), (15, 38))), # or (9/38, 7/38)
  131: ((74523817551625, 484), ((3, 22), (1, 11))),
  132: ((1650390625, 2), ((1, 2), (1, 2))),
  133: ((13350143275625, 242), ((5, 22), (1, 22))),
  134: ((1488093693125, 98), ((1, 2), (1, 14))),
  135: ((25672050625, 18), ((1, 6), (1, 6))),
  136: ((10215624428425, 144), ((5, 12), (0, 1))),
  136: ((1488093693125, 98), ((5, 14), (5, 14))),
  137: ((642879813168125, 1682), ((21, 58), (13, 58))),
  138: ((949865873125, 98), ((1, 2), (3, 14))),
  139: ((1526424492393125, 1682), ((17, 58), (15, 58))),
  140: ((446265625, 2), ((1, 2), (1, 2))),
  141: ((959374490420125, 1682), ((19, 58), (11, 58))),
  142: ((494279058883025, 1058), ((1, 2), (19, 46))),
  143: ((494279058883025, 1058), ((17, 46), (7, 46))),
  145: ((494279058883025, 1058), ((21, 46), (9, 46))),
  146: ((494279058883025, 1058), ((13, 46), (13, 46))),
  147: ((880250821107125, 1682), ((25, 58), (11, 58))),
  148: ((9266713015625, 242), ((1, 2), (3, 22))),
  149: ((8051406390625, 242), ((7, 22), (5, 22))),
  150: ((5158830625, 4), ((1, 2), (0, 1))),
  151: ((293377538813125, 256), ((3, 8), (1, 16))),
  152: ((8051406390625, 162), ((7, 18), (7, 18))),
  153: ((51078122142125, 722), ((13, 38), (9, 38))),
  154: ((51078122142125, 722), ((7, 38), (7, 38))), # or (15/38, 5/38)
  155: ((83695979711825, 722), ((3, 38), (1, 38))),
  156: ((2013715651025, 98), ((1, 2), (3, 14))),
  157: ((372619087758125, 484), ((5, 11), (3, 22))),
  158: ((257647168338625, 722), ((9, 38), (9, 38))),
  159: ((22610779758125, 242), ((9, 22), (5, 22))),
  161: ((116726069288725, 256), ((7, 16), (3, 8))),
  162: ((1026882025, 4), ((1, 2), (0, 1))),
  163: ((116726069288725, 256), ((7, 16), (1, 8))),
  164: ((2202378665825, 98), ((3, 14), (3, 14))),
  165: ((105338160089825, 144), ((5, 12), (1, 3))),
  166: ((203641668953125, 256), ((1, 8), (1, 16))),
  167: ((2185791364771625, 1682), ((21, 58), (3, 58))),
  169: ((556062330962125, 484), ((7, 22), (1, 11))),
  170: ((3929086318625, 242), ((5, 22), (3, 22))),
  171: ((5732601350125, 242), ((9, 22), (3, 22))),
  172: ((3929086318625, 242), ((1, 2), (1, 22))),
  173: ((173665615283225, 722), ((9, 38), (3, 38))), # or (15/38, 13/38)
  174: ((207829342879925, 722), ((3, 38), (3, 38))),
  175: ((637821086769425, 722), ((11, 38), (9, 38))),
  176: ((2158203125, 2), ((1, 2), (1, 2))),
  177: ((1803792666203125, 722), ((7, 38), (5, 38))),
  178: ((105893667855625, 256), ((1, 2), (3, 16))),
  179: ((491135789828125, 722), ((13, 38), (5, 38))), # or (15/38, 11/38)
  181: ((4341640382080625, 1024), ((15, 32), (1, 8))),
  182: ((105893667855625, 256), ((3, 16), (0, 1))),
  183: ((4401254105535625, 1682), ((15, 58), (5, 58))),
  184: ((1735961768125, 98), ((5, 14), (5, 14))),
  185: ((4796872452100625, 1682), ((27, 58), (17, 58))),
  186: ((23746646828125, 98), ((1, 2), (1, 14))),
  187: ((333753581890625, 242), ((5, 22), (3, 22))),
  188: ((37202342328125, 98), ((3, 14), (3, 14))),
  189: ((641801265625, 18), ((1, 6), (1, 6))),
  190: ((37202342328125, 98), ((1, 2), (5, 14))),
  191: ((2662030314933925, 1058), ((19, 46), (3, 46))),
  193: ((2662030314933925, 1058), ((17, 46), (9, 46))),
  194: ((2662030314933925, 1058), ((1, 46), (1, 46))),
  195: ((2345749485436825, 1058), ((21, 46), (7, 46))),
  196: ((75418890625, 2), ((1, 2), (1, 2))),
  # 197: missing
  198: ((476962890625, 4), ((1, 2), (0, 1))),
  199: ((2953032929419625, 722), ((13, 38), (11, 38))),
  201: ((43154717100625, 98), ((5, 14), (5, 14))),
  202: ((812579530914125, 722), ((11, 38), (11, 38))),
  203: ((190937814900625, 98), ((3, 14), (3, 14))),
  204: ((286823301259625, 722), ((1, 2), (7, 38))),
  205: ((286823301259625, 722), ((9, 38), (5, 38))),
  206: ((381121372906625, 722), ((3, 38), (3, 38))),
  207: ((35145037305625, 98), ((3, 14), (3, 14))),
  208: ((53955078125, 2), ((1, 2), (1, 2))),
  209: ((3124267735818125, 484), ((5, 11), (7, 22))),
  210: ((128970765625, 4), ((1, 2), (0, 1))),
  211: ((7334438470328125, 256), ((5, 16), (1, 8))),
  212: ((19645431593125, 242), ((1, 2), (7, 22))),
  213: ((28663006750625, 242), ((3, 22), (1, 22))),
  214: ((19645431593125, 242), ((9, 22), (1, 22))),
  215: ((2780311654810625, 484), ((3, 11), (3, 22))),
  217: ((17076865929478225, 841), ((7, 29), (1, 29))),
  218: ((427810418136725, 256), ((7, 16), (1, 8))),
  219: ((17076865929478225, 841), ((11, 29), (4, 29))),
  220: ((278916015625, 2), ((1, 2), (1, 2))),
  221: ((17076865929478225, 841), ((14, 29), (12, 29))),
  221: ((9315477193953125, 484), ((5, 22), (2, 11))),
  222: ((160527332558125, 98), ((1, 2), (3, 14))),
  225: ((4338576555625, 18), ((1, 6), (1, 6))),
  226: ((251487834138125, 98), ((1, 2), (1, 14))),
  227: ((9315477193953125, 484), ((7, 22), (3, 11))),
  228: ((160527332558125, 98), ((1, 14), (1, 14))),
  229: ((1088047736253725, 722), ((11, 38), (3, 38))),
  230: ((745740583275025, 722), ((1, 38), (1, 38))), # or (15/38, 9/38)
  231: ((745740583275025, 722), ((17, 38), (13, 38))),
  232: ((1088047736253725, 722), ((1, 2), (15, 38))),
  233: ((39993447508015625, 242), ((9, 22), (1, 22))),
  234: ((74507479087925, 98), ((3, 14), (3, 14))),
  235: ((5032128994140625, 242), ((7, 22), (1, 22))),
  236: ((594633673343125, 256), ((7, 16), (3, 8))),
  238: ((6334524491888125, 484), ((1, 11), (1, 22))),
  242: ((3385056009373025, 256), ((1, 16), (0, 1))),
  242: ((221487865284725, 98), ((1, 2), (1, 14))),
  243: ((1405801492225, 18), ((1, 6), (1, 6))),
  244: ((221487865284725, 98), ((5, 14), (5, 14))),
  245: ((6299061163890625, 18), ((1, 6), (1, 6))),
  246: ((63868981308925, 98), ((1, 2), (5, 14))),
  248: ((43399044203125, 98), ((3, 14), (3, 14))),
  250: ((1490902050625, 4), ((1, 2), (0, 1))),
  252: ((763140625, 2), ((1, 2), (1, 2))),
  253: ((7228810302507625, 484), ((5, 22), (1, 11))),
  254: ((2647341696390625, 256), ((1, 16), (0, 1))),
  255: ((239674265436125, 242), ((7, 22), (1, 22))),
  258: ((239674265436125, 242), ((5, 22), (5, 22))),
  259: ((5036302843213525, 722), ((5, 38), (1, 38))), # or (13/38, 3/38)
  260: ((6972900390625, 2), ((1, 2), (1, 2))),
  261: ((56404355339515625, 242), ((5, 22), (1, 22))),
  262: ((8123096113127125, 484), ((1, 2), (4, 11))),
  264: ((28056640625, 2), ((1, 2), (1, 2))),
  265: ((31346215614390625, 64),  ((1, 8), (0, 1))),
  266: ((707557593608125, 242), ((1, 2), (5, 22))),
  267: ((707557593608125, 242), ((7, 22), (3, 22))),
  268: ((55059466645625, 98), ((1, 14), (1, 14))),
  269: ((6384765267765625, 722), ((9, 38), (3, 38))), # or (15/38, 13/38)
  270: ((25672050625, 4), ((1, 2), (0, 1))),
  271: ((2918151732218125, 256), ((3, 16), (1, 8))),
  272: ((55059466645625, 98), ((1, 2), (3, 14))),
  273: ((2633454002245625, 144), ((5, 12), (1, 3))),
# 274: ((4477025219079656043125, 1682), ((13, 58), (3, 58))),
  275: ((23295344541015625, 18), ((1, 6), (1, 6))),
  276: ((50342891275625, 98), ((1, 2), (1, 14))),
  279: ((878625932640625, 98), ((1, 14), (1, 14))),
  280: ((7586515625, 2), ((1, 2), (1, 2))),
  282: ((1078867927515625, 98), ((1, 2), (5, 14))),
  283: ((4773445372515625, 98), ((1, 14), (1, 14))),
  284: ((3587025813607925, 256), ((7, 16), (1, 8))),
  285: ((1078867927515625, 98), ((3, 14), (3, 14))),
  292: ((3587025813607925, 256), ((7, 16), (3, 8))),
  294: ((21796059390625, 4), ((1, 2), (0, 1))),
  296: ((676470050140625, 242), ((9, 22), (9, 22))),
  297: ((401125791015625,18), ((1, 6), (1, 6))),
  298: ((491135789828125, 242), ((5, 22), (1, 22))),
  299: ((716575168765625, 242), ((7, 22), (5, 22))),
  300: ((5158830625, 2), ((1, 2), (1, 2))),
  301: ((59078807710755625, 256), ((3, 16), (0, 1))),
  302: ((12028479091338125, 144), ((1, 6), (1, 12))),
  303: ((59078807710755625, 144), ((5, 12), (0, 1))),
  304: ((293377538813125, 98), ((1, 2), (1, 14))),
  305: ((8453293950894325, 722), ((15, 38), (5, 38))),
  306: ((4954577847786125, 722), ((1, 2), (5, 38))),
  307: ((3728702916375125, 722), ((3, 38), (1, 38))), # or (17/38, 5/38)
  308: ((3728702916375125, 722), ((9, 38), (9, 38))),
  310: ((8453293950894325, 722), ((7, 38), (7, 38))),
  312: ((701416015625, 2), ((1, 2), (1, 2))),
  314: ((6287195853453125, 98), ((1, 2), (5, 14))),
  315: ((108464413890625, 18), ((1, 6), (1, 6))),
  316: ((6287195853453125, 98), ((3, 14), (3, 14))),
  318: ((1198371327180625, 242), ((9, 22), (9, 22))),
  321: ((1198371327180625, 242), ((7, 22), (5, 22))),
  322: ((7120290226612225, 256), ((1, 2), (1, 16))),
  324: ((1026882025, 2), ((1, 2), (1, 2))),
  325: ((582383613525390625, 18), ((1, 6), (1, 6))),
  326: ((7120290226612225, 256), ((1, 16), (0, 1))),
  328: ((116726069288725, 98), ((1, 14), (1, 14))),  
  330: ((80606728515625, 4), ((1, 2), (0, 1))),
  332: ((9315477193953125, 144), ((1, 6), (1, 12))),
  333: ((5939511304650625, 98), ((3, 14), (3, 14))),
  335: ((7293147190005625, 36), ((1, 6), (0, 1))),
  336: ((1301828125, 2), ((1, 2), (1, 2))),
  339: ((7293147190005625, 98), ((5, 14), (5, 14))),
  340: ((286823301259625, 242), ((9, 22), (5, 22))),
  341: ((556062330962125, 242), ((9, 22), (5, 22))),
  342: ((349688682357625, 242), ((5, 22), (3, 22))),
  344: ((286823301259625, 242), ((3, 22), (3, 22))),
  345: ((5939511304650625, 36), ((1, 6), (0, 1))),
  348: ((9449452596293125, 144), ((1, 2), (5, 12))),
  350: ((37272551265625, 4), ((1, 2), (0, 1))),
  351: ((3948896391660025, 98), ((1, 14), (1, 14))),
  352: ((62587890625, 2), ((1, 2), (1, 2))),
  356: ((4341640382080625, 144), ((5, 12), (1, 3))),
  360: ((885243125, 2), ((1, 2), (1, 2))),
  363: ((3948896391660025, 64), ((3, 8), (0, 1))),
  364: ((4341640382080625, 144), ((1, 3), (1, 12))),
  366: ((3948896391660025, 64), ((1, 2), (3, 8))),
  368: ((189219832725625, 98), ((1, 2), (5, 14))),
  369: ((2363152308430225, 98), ((5, 14), (5, 14))),
  370: ((46392399109298125, 36), ((1, 6), (0, 1))),
  372: ((1258572281890625, 98), ((1, 2), (5, 14))),
  373: ((17688939840203125, 242), ((9, 22), (7, 22))),
  374: ((17688939840203125, 242), ((1, 2), (3, 22))),
  375: ((1253848624575625, 18), ((1, 6), (1, 6))),
  376: ((1376486666140625, 98), ((1, 2), (1, 14))),
  378: ((641801265625, 4), ((1, 2), (0, 1))),
  380: ((1376486666140625, 98), ((5, 14), (5, 14))),
  387: ((8537904570372125, 162), ((1, 6), (1, 18))),
  390: ((2015168212890625, 4), ((1, 2), (0, 1))),
  392: ((1282121140625, 2), ((1, 2), (1, 2))),
  396: ((476962890625, 2), ((1, 2), (1, 2))),
  400: ((8800358125, 2), ((1, 2), (1, 2))),
  402: ((1596724532723125, 98), ((1, 2), (3, 14))),
  404: ((5537196632118125, 98), ((3, 14), (3, 14))),
  405: ((35145037305625, 18), ((1, 6), (1, 6))),
  406: ((5537196632118125, 98), ((1, 2), (5, 14))),
  408: ((1596724532723125, 98), ((1, 14), (1, 14))),
  409: ((99045822390973705, 361), ((7, 19), (4, 19))),
  410: ((99045822390973705, 361), ((8, 19), (1, 19))),
  414: ((1862686977198125, 98), ((1, 14), (1, 14))),
  416: ((1564697265625, 2), ((1, 2), (1, 2))),
  420: ((128970765625, 2), ((1, 2), (1, 2))),
  424: ((1434116506298125, 242), ((1, 22), (1, 22))),
  426: ((1748443411788125, 242), ((9, 22), (1, 22))),
  427: ((2780311654810625, 242), ((9, 22), (3, 22))),
  428: ((1434116506298125, 242), ((9, 22), (3, 22))),
  432: ((1310159825, 2), ((1, 2), (1, 2))),
  440: ((4741572265625, 2), ((1, 2), (1, 2))),
  441: ((18330485947515625, 18), ((1, 6), (1, 6))),
  444: ((8507948625580625, 98), ((1, 2), (1, 14))),
  448: ((3705203125, 2), ((1, 2), (1, 2))),  
  450: ((4338576555625, 4), ((1, 2), (0, 1))),
  452: ((9305049863110625, 98), ((1, 14), (1, 14))),
  456: ((8507948625580625, 98), ((5, 14), (5, 14))),
  460: ((9792167286045625, 36), ((1, 6), (0, 1))),
  462: ((13622537119140625, 4), ((1, 2), (0, 1))),
  468: ((11924072265625, 2), ((1, 2), (1, 2))),
  480: ((1926705625, 2), ((1, 2), (1, 2))),
  484: ((8195051015534825, 98), ((1, 14), (1, 14))),
  486: ((1405801492225, 4), ((1, 2), (0, 1))),
  488: ((8195051015534825, 98), ((1, 2), (3, 14))),
  490: ((6299061163890625, 4), ((1, 2), (0, 1))),
  492: ((3385056009373025, 98), ((1, 2), (3, 14))),
  496: ((4730495818140625, 98), ((1, 2), (3, 14))),
  500: ((1490902050625, 2), ((1, 2), (1, 2))),
  504: ((22131078125, 2), ((1, 2), (1, 2))),
  510: ((1259480133056640625, 4), ((1, 2), (0, 1))),
  512: ((1215306625, 2), ((1, 2), (1, 2))),
  520: ((118539306640625, 2), ((1, 2), (1, 2))),
  525: ((31346215614390625, 18), ((1, 6), (1, 6))),
  528: ((813642578125, 2), ((1, 2), (1, 2))),
  536: ((2918151732218125, 98), ((5, 14), (5, 14))),
  540: ((25672050625, 2), ((1, 2), (1, 2))),
  544: ((2918151732218125, 98), ((1, 2), (1, 14))),
  550: ((23295344541015625, 4), ((1, 2), (0, 1))),
  552: ((5487375149043125, 98), ((3, 14), (3, 14))),
  560: ((220008953125, 2), ((1, 2), (1, 2))),
  564: ((36023663238265625, 64), ((3, 8), (0, 1))),
  567: ((878625932640625, 18), ((1, 6), (1, 6))),
  570: ((36023663238265625, 64), ((1, 2), (3, 8))),
  576: ((3159797225, 2), ((1, 2), (1, 2))),
  588: ((21796059390625, 2), ((1, 2), (1, 2))),
  594: ((401125791015625, 4), ((1, 2), (0, 1))),
  600: ((149606088125, 2), ((1, 2), (1, 2))),
  603: ((59078807710755625, 64), ((3, 8), (0, 1))),
  608: ((24448394775390625, 2), ((1, 2), (1, 2))),
  612: ((59078807710755625, 64), ((1, 2), (3, 8))),
  616: ((801325712890625, 2), ((1, 2), (1, 2))),
  624: ((20341064453125, 2), ((1, 2), (1, 2))),
  630: ((108464413890625, 4), ((1, 2), (0, 1))),
  640: ((6076533125, 2),  ((1, 2), (1, 2))),
  648: ((37994634925, 2), ((1, 2), (1, 2))),
  650: ((582383613525390625, 4), ((1, 2), (0, 1))),
  660: ((80606728515625, 2), ((1, 2), (1, 2))),
  672: ((48167640625, 2), ((1, 2), (1, 2))),
  675: ((5939511304650625, 18), ((1, 6), (1, 6))),
  680: ((99045822390973705, 121), ((4, 11), (0, 1))),
  684: ((99045822390973705, 121), ((2, 11), (1, 11))),
  700: ((37272551265625, 2), ((1, 2), (1, 2))),
  702: ((10028144775390625, 4), ((1, 2), (0, 1))),
  704: ((2315751953125, 2), ((1, 2), (1, 2))),
  720: ((32753995625, 2), ((1, 2), (1, 2))),
  728: ((20033142822265625, 2), ((1, 2), (1, 2))),
  729: ((2363152308430225, 18), ((1, 6), (1, 6))),
  750: ((1253848624575625, 4), ((1, 2), (0, 1))),
  756: ((641801265625, 2), ((1, 2), (1, 2))),
  768: ((12882250225, 2), ((1, 2), (1, 2))),
  780: ((2015168212890625, 2), ((1, 2), (1, 2))),
  784: ((37181513078125, 2), ((1, 2), (1, 2))),
  792: ((13831923828125, 2), ((1, 2), (1, 2))),
  800: ((325613250625, 2), ((1, 2), (1, 2))),
  810: ((35145037305625, 4), ((1, 2), (0, 1))),
  816: ((12713165283203125, 2), ((1, 2), (1, 2))),
  832: ((57893798828125, 2), ((1, 2), (1, 2))),
  840: ((3740152203125, 2), ((1, 2), (1, 2))),
  864: ((53716552825, 2), ((1, 2), (1, 2))),
  880: ((137505595703125, 2), ((1, 2), (1, 2))),
  896: ((151913328125, 2), ((1, 2), (1, 2))),
  900: ((4338576555625, 2), ((1, 2), (1, 2))),
  912: ((317829132080078125, 2), ((1, 2), (1, 2))),
  924: ((13622537119140625, 2), ((1, 2), (1, 2))),
  936: ((345798095703125, 2), ((1, 2), (1, 2))),
  960: ((78994930625, 2), ((1, 2), (1, 2))),
  972: ((1405801492225, 2), ((1, 2), (1, 2))),
  980: ((6299061163890625, 2), ((1, 2), (1, 2))),
  1000: ((43236159468125, 2), ((1, 2), (1, 2))),
  1008: ((818849890625, 2), ((1, 2), (1, 2))),
  1020: ((1259480133056640625, 2), ((1, 2), (1, 2))),
  1024: ((64411251125, 2), ((1, 2), (1, 2))),
  1040: ((3437639892578125, 2), ((1, 2), (1, 2))),
  1050: ((31346215614390625, 4), ((1, 2), (0, 1))),
  1056: ((30104775390625, 2), ((1, 2), (1, 2))),
  1080: ((949865873125, 2), ((1, 2), (1, 2))),
  1088: ((36183624267578125, 2), ((1, 2), (1, 2))),
  1100: ((23295344541015625, 2), ((1, 2), (1, 2))),
  1120: ((8140331265625, 2), ((1, 2), (1, 2))),
  1134: ((878625932640625, 4), ((1, 2), (0, 1))),
  1152: ((167469252925, 2), ((1, 2), (1, 2))),
  1176: ((632085722328125, 2), ((1, 2), (1, 2))),
  1188: ((401125791015625, 2), ((1, 2), (1, 2))),
  1200: ((5535425260625, 2), ((1, 2), (1, 2))),
  1215: ((59078807710755625, 16), ((1, 4), (0, 1))),
  1216: ((904590606689453125, 2), ((1, 2), (1, 2))),
  1224: ((216123809814453125, 2), ((1, 2), (1, 2))),
  1232: ((23238445673828125, 2), ((1, 2), (1, 2))),
  1248: ((752619384765625, 2), ((1, 2), (1, 2))),
  1260: ((108464413890625, 2), ((1, 2), (1, 2))),
  1280: ((322056255625, 2), ((1, 2), (1, 2))),
  1296: ((1557780031925, 2), ((1, 2), (1, 2))),
  1300: ((582383613525390625, 2), ((1, 2), (1, 2))),
  1320: ((2337595126953125, 2), ((1, 2), (1, 2))),
  1344: ((1974873265625, 2), ((1, 2), (1, 2))),
  1350: ((5939511304650625, 4), ((1, 2), (0, 1))),
  1400: ((1080903986703125, 2), ((1, 2), (1, 2))),
  1404: ((10028144775390625, 2), ((1, 2), (1, 2))),
  1408: ((94945830078125, 2), ((1, 2), (1, 2))),
  1440: ((1342913820625, 2), ((1, 2), (1, 2))),
  1456: ((580961141845703125, 2), ((1, 2), (1, 2))),
  1458: ((2363152308430225, 4), ((1, 2), (0, 1))),
  1500: ((1253848624575625, 2), ((1, 2), (1, 2))),
  1512: ((23746646828125, 2), ((1, 2), (1, 2))),
  1536: ((785817263725, 2), ((1, 2), (1, 2))),
  1560: ((58439878173828125, 2), ((1, 2), (1, 2))),
  1568: ((1375715983890625, 2), ((1, 2), (1, 2))),
  1584: ((511781181640625, 2), ((1, 2), (1, 2))),
  1600: ((13350143275625, 2), ((1, 2), (1, 2))),
  1620: ((35145037305625, 2), ((1, 2), (1, 2))),
  1664: ((2373645751953125, 2), ((1, 2), (1, 2))),
  1680: ((138385631515625, 2), ((1, 2), (1, 2))),
  1728: ((2846977299725, 2),  ((1, 2), (1, 2))),
  1760: ((5087707041015625, 2), ((1, 2), (1, 2))),
  1764: ((18330485947515625, 2), ((1, 2), (1, 2))),
  1792: ((8051406390625, 2), ((1, 2), (1, 2))),
  1800: ((160527332558125, 2), ((1, 2), (1, 2))),
  1872: ((12794529541015625, 2), ((1, 2), (1, 2))),
  1920: ((4186731323125, 2), ((1, 2), (1, 2))),
  1944: ((57637861181225, 2), ((1, 2), (1, 2))),
  2000: ((1599737900320625 ,2), ((1, 2), (1, 2))),
  2016: ((33572845515625, 2), ((1, 2), (1, 2))),
  2048: ((3929086318625, 2), ((1, 2), (1, 2))),
  2100: ((31346215614390625, 2), ((1, 2), (1, 2))),
  2112: ((1234295791015625, 2), ((1, 2), (1, 2))),
  2160: ((38944500798125, 2), ((1, 2), (1, 2))),
  2240: ((333753581890625, 2), ((1, 2), (1, 2))),
  2268: ((878625932640625, 2), ((1, 2), (1, 2))),
  2304: ((10215624428425, 2), ((1, 2), (1, 2))),
  2352: ((23387171726140625, 2), ((1, 2), (1, 2))),
  2376: ((14841654267578125, 2), ((1, 2), (1, 2))),
  2400: ((226952435685625, 2), ((1, 2), (1, 2))),
  2430: ((59078807710755625, 4), ((1, 2), (0, 1))),
  2496: ((30857394775390625, 2), ((1, 2), (1, 2))),
  2520: ((4013183313953125, 2), ((1, 2), (1, 2))),
  2560: ((19645431593125, 2), ((1, 2), (1, 2))),
  2592: ((82562341692025, 2), ((1, 2), (1, 2))),
  2688: ((104668283078125, 2), ((1, 2), (1, 2))),
  2700: ((5939511304650625, 2), ((1, 2), (1, 2))),
  2800: ((39993447508015625, 2), ((1, 2), (1, 2))),
  2816: ((5032128994140625, 2), ((1, 2), (1, 2))),
  2880: ((71174432493125, 2), ((1, 2), (1, 2))),
  2916: ((2363152308430225, 2), ((1, 2), (1, 2))),
  3000: ((46392399109298125, 2), ((1, 2), (1, 2))),
  3024: ((973612519953125, 2), ((1, 2), (1, 2))),
  3072: ((51078122142125, 2), ((1, 2), (1, 2))),
  3136: ((56404355339515625, 2), ((1, 2), (1, 2))),
  3168: ((20983028447265625, 2), ((1, 2), (1, 2))),
  3200: ((707557593608125, 2), ((1, 2), (1, 2))),
  3240: ((1440946529530625, 2), ((1, 2), (1, 2))),
  3360: ((5673810892140625, 2), ((1, 2), (1, 2))),
  3456: ((173665615283225, 2), ((1, 2), (1, 2))),
  3584: ((491135789828125, 2), ((1, 2), (1, 2))),
  3600: ((6581620634883125, 2), ((1, 2), (1, 2))),
  3840: ((255390610710625, 2), ((1, 2), (1, 2))),
  3888: ((3054806642604925, 2), ((1, 2), (1, 2))),
  4032: ((1779360812328125, 2), ((1, 2), (1, 2))),
  4096: ((286823301259625, 2), ((1, 2), (1, 2))),
  4320: ((2064058542300625, 2), ((1, 2), (1, 2))),
  4480: ((17688939840203125, 2), ((1, 2), (1, 2))),
  4536: ((36023663238265625, 2), ((1, 2), (1, 2))),
  4608: ((745740583275025, 2), ((1, 2), (1, 2))),
  4800: ((12028479091338125, 2), ((1, 2), (1, 2))),
  5120: ((1434116506298125, 2), ((1, 2), (1, 2))),
  5184: ((5036302843213525, 2), ((1, 2), (1, 2))),
  5376: ((6384765267765625, 2), ((1, 2), (1, 2))),
  5760: ((4341640382080625, 2), ((1, 2), (1, 2))),
  6144: ((3728702916375125, 2), ((1, 2), (1, 2))),
# 7680: ((4477025219079656043125, 2), ((1, 2), (1, 2))),

}

best = dict()
best.update(maybe)
best.update(minimal)

# check the lattice circle with squared radius r2 and n lattice points on its circumference
# against the list of minimal lattice circle found so far. returns:
# v_new = there is no current entry for n
# v_better = this is a smaller circle than the current best for n
# v_error = as v_better, except the current value is known to be minimal
# v_best = the same as the current best
# v_none = larger than the current best
def check(n, r2, v_none='', v_new='[*NEW*]', v_better='[*BETTER*]', v_minimal='[*MINIMAL*]', v_best='[*BEST*]', v_error='[ERROR]'):
  if n not in best: return v_new
  (p2, q2) = best[n][0]
  v2 = r2 * q2
  if v2 < p2: return (v_error if n in minimal else v_better)
  if v2 == p2: return (v_minimal if n in minimal else v_best)
  return v_none


if __name__ == "__main__":

  # output the list as text

  unpack = lambda fn: (lambda vs: fn(*vs))
  R = unpack(lambda a, b: "{r:10.3f}".format(r=(float(a) / float(b)) ** 0.5))
  F = unpack(lambda a, b: ("{a}" if b == 1 else "{a}/{b}").format(a=a, b=b))
  P = lambda a, b: "({a}, {b})".format(a=a, b=b)

  def R(v):
    (a, b) = v
    r = (float(a) / float(b)) ** 0.5
    s = "{r:10.9f}".format(r=r)
    if s.endswith('000000'):
      if s.endswith('000000000'): return s[:-10] + '    '
      if s.endswith('00000000'): return s[:-8] + '  '
      if s.endswith('0000000'): return s[:-7] + ' '
      return s[:-6]
    return "{r:10.3f}".format(r=r)

  # output verified minimum radius lattice circles
  print("the following circles are verified minimal radius:\n")

  fmt="  {n:>3}    {r:>10}    {r2:<14}    {centre}"
  print(fmt.format(n='n', r='r    ', r2='r^2', centre='centre'))
  for n in sorted(minimal.keys()):
    (r2, (x, y)) = minimal[n]
    print(fmt.format(n=n, r=R(r2), r2=F(r2), centre=P(F(x), F(y))))

  # output verified best radius lattice circles
  print("\n\nthe following circles are smallest radius found so far:\n")

  fmt="  {n:>4}    {r:>14}    {r2:<22}    {centre}{s}"
  print(fmt.format(n='n', r='r    ', r2='r^2', centre='centre', s=''))
  for n in sorted(best.keys()):
    if n in minimal: continue
    (r2, (x, y)) = best[n]
    s = ('    [minimal]' if n in minimal else '')
    print(fmt.format(n=n, r=R(r2), r2=F(r2), centre=P(F(x), F(y)), s=s))


  # output circles ordered by radius
  print("\n\nlattice circles ordered by radius:\n")

  def K(v):
    (n, ((a, b), _)) = v
    return ((float(a) / float(b), n))

  fmt="  {r:>14}    {n:>4}{s}"
  print(fmt.format(n='n', r='r    ', s=''))
  for (n, (r2, _)) in sorted(best.items(), key=K):
    s = ('    [minimal]' if n in minimal else '')
    print(fmt.format(n=n, r=R(r2), s=s))
